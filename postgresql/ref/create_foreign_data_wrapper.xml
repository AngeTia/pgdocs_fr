<?xml version="1.0" encoding="UTF-8"?>
<!-- Dernière modification
     le       $Date: 2009-04-13 17:20:17 +0200 (lun 13 avr 2009) $
     par      $Author: gleu $
     révision $Revision: 1293 $ -->

<refentry id="sql-createforeigndatawrapper">
 <refmeta>
  <refentrytitle>CREATE FOREIGN DATA WRAPPER</refentrytitle>
  <manvolnum>7</manvolnum>
  <refmiscinfo>SQL - Instructions du langage</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>CREATE FOREIGN DATA WRAPPER</refname>
  <refpurpose>définit un nouveau wrapper de données
      distantes</refpurpose>
 </refnamediv>

 <indexterm zone="sql-createforeigndatawrapper">
  <primary>CREATE FOREIGN DATA WRAPPER</primary>
 </indexterm>

 <refsynopsisdiv>
<synopsis>
CREATE FOREIGN DATA WRAPPER <replaceable class="parameter">nom</replaceable>
    [ HANDLER <replaceable class="parameter">handler_function</replaceable> | NO HANDLER ]
    [ VALIDATOR <replaceable class="parameter">fonction_validation</replaceable> | NO VALIDATOR ]
    [ OPTIONS ( <replaceable class="PARAMETER">option</replaceable> '<replaceable class="PARAMETER">valeur</replaceable>' [, ... ] ) ]
</synopsis>
 </refsynopsisdiv>

 <refsect1>
  <title>Description</title>

  <para>
   <command>CREATE FOREIGN DATA WRAPPER</command> crée un nouveau wrapper de
   données distantes. L'utilisateur qui définit un wrapper de données distantes
   devient son propriétaire.
  </para>

  <para>
   Le nom du wrapper de données distantes doit être unique dans la base de
   données.
  </para>

  <para>
   Seuls les super-utilisateurs peuvent créer des wrappers de données distantes.
  </para>
 </refsect1>

 <refsect1>
  <title>Paramètres</title>

  <variablelist>
   <varlistentry>
    <term><replaceable class="parameter">nom</replaceable></term>
    <listitem>
     <para>
      Le nom du wrapper de données distantes à créer.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><literal>HANDLER <replaceable class="parameter">handler_function</replaceable></literal></term>
    <listitem>
     <para>
      <replaceable class="parameter">handler_function</replaceable> is the
      name of a previously registered function that will be called to
      retrieve the execution functions for foreign tables.
      The handler function must take no arguments, and
      its return type must be <type>fdw_handler</type>.
     </para>

     <para>
      It is possible to create a foreign-data wrapper with no handler
      function, but foreign tables using such a wrapper can only be declared,
      not accessed.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><literal>VALIDATOR <replaceable class="parameter">fonction_validation</replaceable></literal></term>
    <listitem>
     <para>
      <replaceable class="parameter">fonction_validation</replaceable> est le
      nom d'une fonction déjà enregistrée qui sera appelée pour vérifier les
      options génériques passées au wrapper de données distantes, ainsi que les
      options fournies au serveur
      distant et aux correspondances d'utilisateurs (<foreignphrase>user
      mappings</foreignphrase>) utilisant le wrapper de données distantes.
      Si aucune fonction de validation n'est spécifiée ou si <literal>NO
      VALIDATOR</literal> est spécifié, alors les options ne seront pas
      vérifiées au moment de la création. (Il est possible que les wrappers
      de données distantes ignorent ou rejettent des spécifications d'options
      invalides à l'exécution, en fonction de l'implémentation) La fonction de
      validation doit prendre deux arguments&nbsp;: l'un du type
      <type>text[]</type>, qui contiendra le tableau d'options, tel qu'il est
      stocké dans les catalogues systèmes, et l'autre de type <type>oid</type>,
      qui sera l'OID du catalogue système contenant les options. Le type de
      retour est inconnu&nbsp;; la fonction doit rapporter les options
      invalides grâce à la fonction <function>ereport(ERROR)</function>.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><literal>OPTIONS ( <replaceable class="PARAMETER">option</replaceable> '<replaceable class="PARAMETER">valeur</replaceable>' [, ... ] )</literal></term>
    <listitem>
     <para>
      Cette clause spécifie les options pour le nouveau wrapper de données
      distantes. Les noms et valeurs d'options autorisés sont spécifiques à
      chaque wrapper de données distantes. Ils sont validés par la
      fonction de validation du wrapper de données distantes. Les noms des
      options doivent être uniques.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </refsect1>

 <refsect1>
  <title>Notes</title>

  <para>
   Pour le moment, la fonctionnalité de wrapper de données distantes est
   rudimentaire. There is no support for updating a foreign table, and optimization of
   queries is primitive (and mostly left to the wrapper, too).
  </para>

  <para>
   Actuellement, une fonction de validation de wrapper de données distantes est
   disponible&nbsp;: <filename>postgresql_fdw_validator</filename>, qui accepte
   les options correspondant aux paramètres de connexion de
   <application>libpq</application>.
  </para>
 </refsect1>

 <refsect1>
  <title>Exemples</title>

  <para>
   Créer un wrapper de données distantes <literal>bidon</literal>&nbsp;:
<programlisting>
CREATE FOREIGN DATA WRAPPER bidon;
</programlisting>
  </para>

  <para>
   Créer un wrapper de données distantes <literal>file</literal> avec
   la fonction de validation
   <literal>file_fdw_validator</literal>&nbsp;:
<programlisting>
CREATE FOREIGN DATA WRAPPER postgresql VALIDATOR postgresql_fdw_validator;
</programlisting>
  </para>

  <para>
   Créer un wrapper de données distantes <literal>monwrapper</literal> avec des
   options&nbsp;:
<programlisting>
CREATE FOREIGN DATA WRAPPER monwrapper
    OPTIONS (debug 'true');
</programlisting>
  </para>
 </refsect1>

 <refsect1>
  <title>Compatibilité</title>

  <para>
   <command>CREATE FOREIGN DATA WRAPPER</command> est conforme à la norme
   ISO/IEC 9075-9 (SQL/MED), à l'exception des clauses <literal>HANDLER</literal> et
   <literal>VALIDATOR</literal> qui sont des extensions, et des clauses
   <literal>LIBRARY</literal> et <literal>LANGUAGE</literal> qui ne sont pas
   implémentées dans PostgreSQL.
  </para>

  <para>
   Notez, cependant, que la fonctionnalité SQL/MED n'est pas encore conforme
   dans son ensemble.
  </para>
 </refsect1>

 <refsect1>
  <title>Voir aussi</title>

  <simplelist type="inline">
   <member><xref linkend="sql-alterforeigndatawrapper"/></member>
   <member><xref linkend="sql-dropforeigndatawrapper"/></member>
   <member><xref linkend="sql-createserver"/></member>
   <member><xref linkend="sql-createusermapping"/></member>
  </simplelist>
 </refsect1>

</refentry>
