<?xml version="1.0" encoding="UTF-8"?>
<!-- Dernière modification
     le       $Date$
     par      $Author$
     révision $Revision$ -->
<!-- SAS 20060616 : Relecture -->

<refentry id="sql-alteraggregate">
 <indexterm zone="sql-alteraggregate">
  <primary>ALTER AGGREGATE</primary>
 </indexterm>

 <refmeta>
  <refentrytitle>ALTER AGGREGATE</refentrytitle>
  <manvolnum>7</manvolnum>
  <refmiscinfo>SQL - Instructions du langage</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>ALTER AGGREGATE</refname>
  <refpurpose>Modifier la définition d'une fonction d'agrégat</refpurpose>
 </refnamediv>  

 <refsynopsisdiv>
<synopsis>+ALTER AGGREGATE <replaceable>name</replaceable> ( <replaceable>aggregate_signature</replaceable> ) RENAME TO <replaceable>new_name</replaceable>
ALTER AGGREGATE <replaceable>name</replaceable> ( <replaceable>aggregate_signature</replaceable> ) OWNER TO <replaceable>new_owner</replaceable>
ALTER AGGREGATE <replaceable>name</replaceable> ( <replaceable>aggregate_signature</replaceable> ) SET SCHEMA <replaceable>new_schema</replaceable>

<phrase>where <replaceable>aggregate_signature</replaceable> is:</phrase>

* |
[ <replaceable>argmode</replaceable> ] [ <replaceable>argname</replaceable> ] <replaceable>argtype</replaceable> [ , ... ] |
[ [ <replaceable>argmode</replaceable> ] [ <replaceable>argname</replaceable> ] <replaceable>argtype</replaceable> [ , ... ] ] ORDER BY [ <replaceable>argmode</replaceable> ] [ <replaceable>argname</replaceable> ] <replaceable>argtype</replaceable> [ , ... ]

</synopsis>
 </refsynopsisdiv>

 <refsect1>
  <title>Description</title>

  <para>
   <command>ALTER AGGREGATE</command> change la définition d'une fonction
   d'agrégat.
  </para>

  <para>
   Seul le propriétaire de la fonction d'agrégat peut utiliser 
   <command>ALTER AGGREGATE</command>. Pour modifier le schéma 
   d'une fonction d'agrégat, il est
   nécessaire de posséder le droit <literal>CREATE</literal> sur le nouveau schéma.
   Pour modifier le propriétaire de la fonction, il faut être un membre direct ou
   indirect du nouveau rôle propriétaire, rôle qui doit en outre posséder le droit
   <literal>CREATE</literal> sur le schéma de la fonction d'agrégat.
   Ces restrictions assurent que la modification du propriétaire 
   ne permet pas d'aller au-delà de ce que permet la suppression et
   la recréation d'une fonction d'agrégat. Toutefois, un superutilisateur
   peut modifier la possession de n'importe quelle fonction d'agrégat.
  </para>
 </refsect1>

 <refsect1>
  <title>Paramètres</title>

  <variablelist>
   <varlistentry>
    <term><replaceable class="parameter">nom</replaceable></term>
    <listitem>
     <para>
      Le nom (éventuellement qualifié du nom du schéma) de la fonction d'agrégat.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">argmode</replaceable></term>

    <listitem>
     <para>
      The mode of an argument: <literal>IN</literal> or <literal>VARIADIC</literal>.
      If omitted, the default is <literal>IN</literal>.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">argname</replaceable></term>

    <listitem>
     <para>
      The name of an argument.
      Note that <command>ALTER AGGREGATE</command> does not actually pay
      any attention to argument names, since only the argument data
      types are needed to determine the aggregate function's identity.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">type_arg</replaceable></term>
    <listitem>
     <para>
      Un type de données en entrée sur lequel la fonction d'agrégat opère.
      Pour référencer une fonction d'agrégat sans argument, écrivez <literal>*</literal>
      à la place de la liste des  argument specifications.
      To reference an ordered-set aggregate function, write
      <literal>ORDER BY</literal> between the direct and aggregated argument
      specifications.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">nouveau_nom</replaceable></term>
    <listitem>
     <para>
      Le nouveau nom de la fonction d'agrégat.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">nouveau_propriétaire</replaceable></term>
    <listitem>
     <para>
      Le nouveau propriétaire de la fonction d'agrégat. 
      <!-- SAS : Conflit avec ce qui est écrit plus haut
      Seul un superutilisateur peut modifier le propriétaire de l'agrégat.
      -->
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">nouveau_schema</replaceable></term>
    <listitem>
     <para>
      Le nouveau schéma de la fonction d'agrégat.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </refsect1>

 <refsect1>
  <title>Notes</title>

   <para>
    The recommended syntax for referencing an ordered-set aggregate
    is to write <literal>ORDER BY</literal> between the direct and aggregated
    argument specifications, in the same style as in
    <xref linkend="sql-createaggregate"/>.  However, it will also work to
    omit <literal>ORDER BY</literal> and just run the direct and aggregated
    argument specifications into a single list.  In this abbreviated form,
    if <literal>VARIADIC "any"</literal> was used in both the direct and
    aggregated argument lists, write <literal>VARIADIC "any"</literal> only once.
   </para>
 </refsect1>

 <refsect1>
  <title>Exemples</title>

  <para>
   Renommer la fonction d'agrégat <literal>mamoyenne</literal> de type
   <type>integer</type> en <literal>ma_moyenne</literal>&nbsp;:
<programlisting>ALTER AGGREGATE mamoyenne(integer) RENAME TO ma_moyenne;
</programlisting>
  </para>

  <para>
   Changer le propriétaire de la fonction d'agrégat
   <literal>mamoyenne</literal> de type
   <type>integer</type> en <literal>joe</literal>&nbsp;:
<programlisting>ALTER AGGREGATE mamoyenne(integer) OWNER TO joe;
</programlisting>
  </para>

  <para>
   To move the ordered-set aggregate <literal>mypercentile</literal> with
   direct argument of type <type>float8</type> and aggregated argument
   of type <type>integer</type> into schema <literal>myschema</literal>:
<programlisting>ALTER AGGREGATE mamoyenne(integer) SET SCHEMA monschema;
ALTER AGGREGATE mypercentile(float8 ORDER BY integer) SET SCHEMA myschema;
</programlisting>
   This will work too:
<programlisting>
ALTER AGGREGATE mypercentile(float8, integer) SET SCHEMA myschema;
</programlisting>
  </para>
 </refsect1>

 <refsect1>
  <title>Compatibilité</title>

  <para>
   Il n'y a pas de commande <command>ALTER AGGREGATE</command> dans le
   standard SQL.
  </para>
 </refsect1>

 <refsect1>
  <title>Voir aussi</title>

  <simplelist type="inline">
   <member><xref linkend="sql-createaggregate"/></member>
   <member><xref linkend="sql-dropaggregate"/></member>
  </simplelist>
 </refsect1>
</refentry>
